<% content_for :title, "Uploads" %>

<section class="w-full space-y-4">
  <div class="rounded-lg border border-slate-200 bg-white p-4">
    <h2 class="mb-2 text-sm font-medium text-slate-900">Upload CSV</h2>
    <%= form_with scope: :keyword_upload, url: keyword_uploads_path, html: {multipart: true, class: "space-y-3"} do |form| %>
      <div class="flex gap-2">
        <%= form.file_field :file, required: true, accept: ".csv,text/csv", class: "flex-1 rounded border border-slate-300 bg-white px-3 py-2 text-xs" %>
        <%= form.submit "Upload", class: "rounded bg-blue-600 px-4 py-2 text-xs font-medium text-white hover:bg-blue-500" %>
      </div>
      <p class="text-xs text-slate-500">1-100 keywords per file. Processing starts immediately.</p>
    <% end %>
  </div>

  <% if @keyword_uploads.any? %>
    <div class="overflow-hidden rounded-lg border border-slate-200 bg-white">
      <table class="min-w-full divide-y divide-slate-200">
        <thead class="bg-slate-50">
          <tr>
            <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-slate-500">FILENAME</th>
            <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-slate-500">KEYWORDS</th>
            <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-slate-500">PROGRESS</th>
            <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-slate-500">STATUS</th>
            <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-slate-500">UPLOADED</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-slate-100">
          <% @keyword_uploads.each do |upload| %>
            <tr class="hover:bg-slate-50">
              <td class="px-3 py-2 text-xs font-medium text-slate-900 truncate max-w-48"><%= upload.original_filename %></td>
              <td class="px-3 py-2 text-xs text-slate-600"><%= upload.keyword_count %></td>
              <td class="px-3 py-2 text-xs text-slate-600"><%= upload.progress_percent %>%</td>
              <td class="px-3 py-2 text-xs">
                <span class="inline-flex rounded bg-slate-100 px-2 py-1 text-xs font-medium text-slate-600">
                  <%= upload.status.humanize %>
                </span>
              </td>
              <td class="px-3 py-2 text-xs text-slate-500"><%= l(upload.created_at, format: :short) %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <div class="rounded-lg border border-slate-200 bg-white p-4 text-xs text-slate-600">
      No keyword uploads yet. Upload your first CSV to begin scraping.
    </div>
  <% end %>
</section>
